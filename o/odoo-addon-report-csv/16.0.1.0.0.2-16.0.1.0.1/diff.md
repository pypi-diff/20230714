# Comparing `tmp/odoo_addon_report_csv-16.0.1.0.0.2-py3-none-any.whl.zip` & `tmp/odoo_addon_report_csv-16.0.1.0.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,26 +1,26 @@
-Zip file size: 28686 bytes, number of entries: 24
--rw-r--r--  2.0 unx     3812 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/README.rst
--rw-r--r--  2.0 unx       68 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/__init__.py
--rw-r--r--  2.0 unx      615 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/__manifest__.py
--rw-r--r--  2.0 unx       19 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/controllers/__init__.py
--rw-r--r--  2.0 unx     4364 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/controllers/main.py
--rw-r--r--  2.0 unx      505 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/demo/report.xml
--rw-r--r--  2.0 unx     1503 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/i18n/report_csv.pot
--rw-r--r--  2.0 unx       24 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/models/__init__.py
--rw-r--r--  2.0 unx     1204 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/models/ir_report.py
--rw-r--r--  2.0 unx      138 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       66 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx     1051 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/readme/USAGE.rst
--rw-r--r--  2.0 unx       58 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/report/__init__.py
--rw-r--r--  2.0 unx     2195 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/report/report_csv.py
--rw-r--r--  2.0 unx      744 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/report/report_partner_csv.py
--rw-r--r--  2.0 unx     9455 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/static/description/icon.png
--rw-r--r--  2.0 unx    13325 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/static/description/index.html
--rw-r--r--  2.0 unx     2226 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/static/src/js/report/qwebactionmanager.esm.js
--rw-r--r--  2.0 unx       26 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/tests/__init__.py
--rw-r--r--  2.0 unx     2030 b- defN 23-Mar-20 15:37 odoo/addons/report_csv/tests/test_report.py
--rw-r--r--  2.0 unx     4359 b- defN 23-Mar-20 15:37 odoo_addon_report_csv-16.0.1.0.0.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Mar-20 15:37 odoo_addon_report_csv-16.0.1.0.0.2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Mar-20 15:37 odoo_addon_report_csv-16.0.1.0.0.2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2380 b- defN 23-Mar-20 15:37 odoo_addon_report_csv-16.0.1.0.0.2.dist-info/RECORD
-24 files, 50264 bytes uncompressed, 24668 bytes compressed:  50.9%
+Zip file size: 29243 bytes, number of entries: 24
+-rw-r--r--  2.0 unx     3812 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/README.rst
+-rw-r--r--  2.0 unx       68 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/__init__.py
+-rw-r--r--  2.0 unx      615 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/__manifest__.py
+-rw-r--r--  2.0 unx       19 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/controllers/__init__.py
+-rw-r--r--  2.0 unx     4498 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/controllers/main.py
+-rw-r--r--  2.0 unx      505 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/demo/report.xml
+-rw-r--r--  2.0 unx     1503 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/i18n/report_csv.pot
+-rw-r--r--  2.0 unx       24 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/models/__init__.py
+-rw-r--r--  2.0 unx     1204 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/models/ir_report.py
+-rw-r--r--  2.0 unx      138 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       66 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     1051 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/readme/USAGE.rst
+-rw-r--r--  2.0 unx       58 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/report/__init__.py
+-rw-r--r--  2.0 unx     2195 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/report/report_csv.py
+-rw-r--r--  2.0 unx      744 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/report/report_partner_csv.py
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/static/description/icon.png
+-rw-r--r--  2.0 unx    13325 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/static/description/index.html
+-rw-r--r--  2.0 unx     2226 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/static/src/js/report/qwebactionmanager.esm.js
+-rw-r--r--  2.0 unx       26 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/tests/__init__.py
+-rw-r--r--  2.0 unx     4067 b- defN 23-Jul-14 16:32 odoo/addons/report_csv/tests/test_report.py
+-rw-r--r--  2.0 unx     4357 b- defN 23-Jul-14 16:33 odoo_addon_report_csv-16.0.1.0.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-14 16:33 odoo_addon_report_csv-16.0.1.0.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jul-14 16:33 odoo_addon_report_csv-16.0.1.0.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2372 b- defN 23-Jul-14 16:33 odoo_addon_report_csv-16.0.1.0.1.dist-info/RECORD
+24 files, 52425 bytes uncompressed, 25241 bytes compressed:  51.9%
```

## zipnote {}

```diff
@@ -54,20 +54,20 @@
 
 Filename: odoo/addons/report_csv/tests/__init__.py
 Comment: 
 
 Filename: odoo/addons/report_csv/tests/test_report.py
 Comment: 
 
-Filename: odoo_addon_report_csv-16.0.1.0.0.2.dist-info/METADATA
+Filename: odoo_addon_report_csv-16.0.1.0.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_report_csv-16.0.1.0.0.2.dist-info/WHEEL
+Filename: odoo_addon_report_csv-16.0.1.0.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_report_csv-16.0.1.0.0.2.dist-info/top_level.txt
+Filename: odoo_addon_report_csv-16.0.1.0.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_report_csv-16.0.1.0.0.2.dist-info/RECORD
+Filename: odoo_addon_report_csv-16.0.1.0.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/report_csv/__manifest__.py

```diff
@@ -2,15 +2,15 @@
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
 {
     "name": "Base report csv",
     "summary": "Base module to create csv report",
     "author": "Creu Blanca, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/reporting-engine",
     "category": "Reporting",
-    "version": "16.0.1.0.0",
+    "version": "16.0.1.0.1",
     "license": "AGPL-3",
     "depends": ["base", "web"],
     "demo": ["demo/report.xml"],
     "assets": {
         "web.assets_backend": [
             "report_csv/static/src/js/report/qwebactionmanager.esm.js"
         ]
```

## odoo/addons/report_csv/controllers/main.py

```diff
@@ -1,13 +1,14 @@
 # Copyright (C) 2019 Creu Blanca
 # License AGPL-3.0 or later (https://www.gnuorg/licenses/agpl.html).
 
 import json
 import logging
 
+from werkzeug.exceptions import InternalServerError
 from werkzeug.urls import url_decode
 
 from odoo.http import (
     content_disposition,
     request,
     route,
     serialize_exception as _serialize_exception,
@@ -50,14 +51,15 @@
             reportname, docids, converter, **data
         )
 
     @route()
     def report_download(self, data, context=None):
         requestcontent = json.loads(data)
         url, report_type = requestcontent[0], requestcontent[1]
+        reportname = ""
         try:
             if report_type == "csv":
                 reportname = url.split("/report/csv/")[1].split("?")[0]
                 docids = None
                 if "/" in reportname:
                     reportname, docids = reportname.split("/")
                 if docids:
@@ -98,8 +100,9 @@
                 return response
             else:
                 return super(ReportController, self).report_download(data, context)
         except Exception as e:
             _logger.exception("Error while generating report %s", reportname)
             se = _serialize_exception(e)
             error = {"code": 200, "message": "Odoo Server Error", "data": se}
-            return request.make_response(html_escape(json.dumps(error)))
+            res = request.make_response(html_escape(json.dumps(error)))
+            raise InternalServerError(response=res) from e
```

## odoo/addons/report_csv/tests/test_report.py

```diff
@@ -1,21 +1,35 @@
 # Copyright 2019 Creu Blanca
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl.html).
+import json
 import logging
 from io import StringIO
+from unittest import mock
 
+from odoo import http
 from odoo.tests import common
+from odoo.tools import mute_logger
+
+from odoo.addons.web.controllers.report import ReportController
 
 _logger = logging.getLogger(__name__)
 try:
     import csv
 except ImportError:
     _logger.debug("Can not import csv.")
 
 
+class TestCsvException(Exception):
+    def __init__(self, message):
+        """
+        :param message: exception message and frontend modal content
+        """
+        super().__init__(message)
+
+
 class TestReport(common.TransactionCase):
     def setUp(self):
         super().setUp()
         self.report_object = self.env["ir.actions.report"]
         self.csv_report = self.env["report.report_csv.abstract"].with_context(
             active_model="res.partner"
         )
@@ -51,7 +65,53 @@
             self.docs.ids, {"data": [self.report_name, self.report.report_type]}
         )
         self.assertEqual(objs, self.docs)
 
         # Typical call from render
         objs = self.csv_report._get_objs_for_report(self.docs.ids, {})
         self.assertEqual(objs, self.docs)
+
+
+class TestCsvReport(common.HttpCase):
+    """
+    Some tests calling controller
+    """
+
+    def setUp(self):
+        super().setUp()
+        self.report_object = self.env["ir.actions.report"]
+        self.csv_report = self.env["report.report_csv.abstract"].with_context(
+            active_model="res.partner"
+        )
+        self.report_name = "report_csv.partner_csv"
+        self.report = self.report_object._get_report_from_name(self.report_name)
+        self.docs = self.env["res.company"].search([], limit=1).partner_id
+        self.session = self.authenticate("admin", "admin")
+
+    def test_csv(self):
+        filename = self.get_report_headers().headers.get("Content-Disposition")
+        self.assertTrue(".csv" in filename)
+
+    @mute_logger("odoo.addons.web.controllers.report")
+    def test_pdf_error(self):
+        with mock.patch.object(
+            ReportController, "report_routes"
+        ) as route_patch, self.assertLogs(
+            "odoo.addons.report_csv.controllers.main", level=logging.ERROR
+        ) as cm:
+            route_patch.side_effect = TestCsvException("Test")
+            self.get_report_headers(
+                suffix="/report/pdf/test/10", f_type="qweb-pdf"
+            ).headers.get("Content-Disposition")
+            [msg] = cm.output
+            self.assertIn("Error while generating report", msg)
+
+    def get_report_headers(
+        self, suffix="/report/csv/report_csv.partner_csv/1", f_type="csv"
+    ):
+        return self.url_open(
+            url="/report/download",
+            data={
+                "data": json.dumps([suffix, f_type]),
+                "csrf_token": http.Request.csrf_token(self),
+            },
+        )
```

## Comparing `odoo_addon_report_csv-16.0.1.0.0.2.dist-info/METADATA` & `odoo_addon_report_csv-16.0.1.0.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-report-csv
-Version: 16.0.1.0.0.2
+Version: 16.0.1.0.1
 Summary: Base module to create csv report
 Home-page: https://github.com/OCA/reporting-engine
 Author: Creu Blanca, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo_addon_report_csv-16.0.1.0.0.2.dist-info/RECORD` & `odoo_addon_report_csv-16.0.1.0.1.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 odoo/addons/report_csv/README.rst,sha256=RkuIzBO2J-NUScMwF-9OtLJhwyVCNz7e7YskemBSTq0,3812
 odoo/addons/report_csv/__init__.py,sha256=UDc4zQiSVo3VzdZ0hdwnE8XHcE_qxgIm41icJJtEyck,68
-odoo/addons/report_csv/__manifest__.py,sha256=HYdByYzP8Ry_JIR8Uq78jYnl_IkiMKH0N7ybe_ObQ2w,615
+odoo/addons/report_csv/__manifest__.py,sha256=aXxhZWkpa_h122fU1Z5lFqrYNBRPcwjARwI2rx_imYA,615
 odoo/addons/report_csv/controllers/__init__.py,sha256=4KFqEP2QHFbPN66eQJMdGsmNz2v7ywWv_FR1pW_kkLk,19
-odoo/addons/report_csv/controllers/main.py,sha256=hnT5m3LD09UXjIJyaXIzC4LwFUeeBN9kqKftUjsoMQI,4364
+odoo/addons/report_csv/controllers/main.py,sha256=waRGe7itYh7YhU8bs_YsE4i8f3ozojRxsK9_2V4P_E8,4498
 odoo/addons/report_csv/demo/report.xml,sha256=x6EsSixLNGRWh8Bnbme7ufJCl4v2aoqdbfSSt_X6cDU,505
 odoo/addons/report_csv/i18n/report_csv.pot,sha256=p-ekXxgH8VV91PI0QQPh6s5THshnIAMqXqRwBKVR0tg,1503
 odoo/addons/report_csv/models/__init__.py,sha256=rIjyj14jv0HgU8mUMYNsokb4b7otwjga1idwOswlIBY,24
 odoo/addons/report_csv/models/ir_report.py,sha256=tsf66EyBDprjWM_HvnJZ7ymFqub9WC3_cmXapoRph3I,1204
 odoo/addons/report_csv/readme/CONTRIBUTORS.rst,sha256=DzrPccyzIhswSOBq9GhXlsCpdJ_5p8P1f3Lr2nhgbLg,138
 odoo/addons/report_csv/readme/DESCRIPTION.rst,sha256=N1UyQGfbUfk8jzI-xbuqqpofRUbRQ7zfwuJjnNc9U1c,66
 odoo/addons/report_csv/readme/USAGE.rst,sha256=Ao_CjgfmoFwEaQSC9Ao640ARBHEy4fYWpRo4UXQkG-8,1051
 odoo/addons/report_csv/report/__init__.py,sha256=pJkrCZjR1OEAk0Nb118yU1o9snNIyvwzRGk4tuV-rwI,58
 odoo/addons/report_csv/report/report_csv.py,sha256=DkafZUwzlQ473jAoVUQ6hxTCb9wooZWCqs-PshYN7L0,2195
 odoo/addons/report_csv/report/report_partner_csv.py,sha256=H9heR5eDaidayK7E1Aq6pIG_o1xHs2pN6E4ADW1G_YA,744
 odoo/addons/report_csv/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/report_csv/static/description/index.html,sha256=jzP_EwAnNLkkGhjNlMw0o79CwgxOzvsiojVQCWsVaBw,13325
 odoo/addons/report_csv/static/src/js/report/qwebactionmanager.esm.js,sha256=2ZJKnIkdZIP6UL7R3nd06ZYfbaMO9WkvnixAlp8X9M0,2226
 odoo/addons/report_csv/tests/__init__.py,sha256=bmniqbMkuna6Y1OaYP9e2UxIUl5DPrTrL9XRpcRu8C4,26
-odoo/addons/report_csv/tests/test_report.py,sha256=JVqEsPURfzEvEJgVUg6yvk87GHlAOPMFFQcmQnuozQo,2030
-odoo_addon_report_csv-16.0.1.0.0.2.dist-info/METADATA,sha256=OOVbjxmn4vGPrOQ6RudqNIB1qV4InK06HjX4U54_pGA,4359
-odoo_addon_report_csv-16.0.1.0.0.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo_addon_report_csv-16.0.1.0.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_report_csv-16.0.1.0.0.2.dist-info/RECORD,,
+odoo/addons/report_csv/tests/test_report.py,sha256=OgxMIL4qhZyrfuYJjH2heDNaTh-NWbvViXlPktuW-aA,4067
+odoo_addon_report_csv-16.0.1.0.1.dist-info/METADATA,sha256=pYvvzUfffXTmJ4b3fr9-uAO-MGI1QKfkhMxGJ7QLNio,4357
+odoo_addon_report_csv-16.0.1.0.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo_addon_report_csv-16.0.1.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_report_csv-16.0.1.0.1.dist-info/RECORD,,
```

